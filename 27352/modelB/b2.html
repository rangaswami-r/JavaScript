<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Space Dodger</title>
    <style>
        body,
        html {
            height: 100%;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: Arial, sans-serif;
        }

        #menu {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        select,
        button {
            margin: 10px;
            padding: 10px;
            font-size: 16px;
        }

        canvas {
            border: 1px solid black;
            display: none;
        }
    </style>
</head>

<body>
    <div id="menu">
        <h1>Space Dodger</h1>
        <select id="themeSelect">
            <option value="black">Black</option>
            <option value="blue">Blue</option>
            <option value="white">White</option>
        </select>
        <select id="difficultySelect">
            <option value="easy">Easy</option>
            <option value="medium">Medium</option>
            <option value="hard">Hard</option>
        </select>
        <button onclick="startGame()">Start Game</button>
    </div>
    <canvas id="gameCanvas" width="480" height="320"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const menu = document.getElementById('menu');
        let theme, difficulty, gameSpeed, asteroidFrequency, scoreMultiplier;

        function startGame() {
            theme = document.getElementById('themeSelect').value;
            difficulty = document.getElementById('difficultySelect').value;

            canvas.style.display = 'block';
            menu.style.display = 'none';

            // Set game parameters based on difficulty
            switch (difficulty) {
                case 'easy':
                    gameSpeed = 1;
                    asteroidFrequency = 0.01;
                    scoreMultiplier = 1;
                    break;
                case 'medium':
                    gameSpeed = 1.5;
                    asteroidFrequency = 0.02;
                    scoreMultiplier = 2;
                    break;
                case 'hard':
                    gameSpeed = 2;
                    asteroidFrequency = 0.03;
                    scoreMultiplier = 3;
                    break;
            }

            // Set background color based on theme
            document.body.style.background = theme;

            initGame();
        }

        function initGame() {
            const player = {
                x: canvas.width / 2 - 15,
                y: canvas.height - 30,
                width: 30,
                height: 30,
                speed: 5,
                dx: 0
            };

            const asteroids = [];
            const stars = [];
            let score = 0;
            let isGameOver = false;

            function update() {
                if (isGameOver) return;
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                player.x += player.dx;
                drawPlayer();
                if (player.x < 0) player.x = 0;
                if (player.x > canvas.width - player.width) player.x = canvas.width - player.width;


                // Asteroids and stars
                if (Math.random() < 0.02 * gameSpeed) asteroids.push({ x: Math.random() * canvas.width, y: 0, radius: 15 });
                if (Math.random() < 0.01) stars.push({ x: Math.random() * canvas.width, y: 0, size: 5 });

                asteroids.forEach((a, index) => {
                    a.y += gameSpeed;
                    drawAsteroid(a);
                    if (a.y > canvas.height) asteroids.splice(index, 1);
                    if (circleRectCollision(a, player)) gameOver();
                });

                stars.forEach((s, index) => {
                    s.y += gameSpeed;
                    drawStar(s);
                    if (s.y > canvas.height) stars.splice(index, 1);
                    if (rectRectCollision(s, player)) {
                        score += 10;
                        stars.splice(index, 1);
                    }
                });

                // Score and speed
                ctx.fillStyle = "white";
                ctx.font = "20px Arial";
                ctx.fillText(`Score: ${score}`, 10, 30);
                gameSpeed += 0.001;

                requestAnimationFrame(update);
            }

            function drawPlayer() {
                ctx.fillStyle = 'blue';
                ctx.fillRect(player.x, player.y, player.width, player.height);
            }

            // Collision detection
            function rectRectCollision(rect1, rect2) {
                return !(rect1.x > rect2.x + rect2.width ||
                    rect1.x + rect1.size < rect2.x ||
                    rect1.y > rect2.y + rect2.height ||
                    rect1.y + rect1.size < rect2.y);
            }

            function circleRectCollision(circle, rect) {
                const distX = Math.abs(circle.x - rect.x - rect.width / 2);
                const distY = Math.abs(circle.y - rect.y - rect.height / 2);

                if (distX > (rect.width / 2 + circle.radius)) return false;
                if (distY > (rect.height / 2 + circle.radius)) return false;

                if (distX <= (rect.width / 2)) return true;
                if (distY <= (rect.height / 2)) return true;

                const dx = distX - rect.width / 2;
                const dy = distY - rect.height / 2;
                return (dx * dx + dy * dy <= (circle.radius * circle.radius));
            }

            // Game over function
            function gameOver() {
                isGameOver = true;
                ctx.fillStyle = "white";
                ctx.font = "30px Arial";
                ctx.fillText("Game Over!", canvas.width / 2 - 90, canvas.height / 2);
                ctx.font = "20px Arial";
                ctx.fillText(`Your Score: ${score}`, canvas.width / 2 - 70, canvas.height / 2 + 30);
            }

            // Key listeners
            document.addEventListener('keydown', function (e) {
                if (e.key === 'ArrowLeft') player.dx = -player.speed;
                if (e.key === 'ArrowRight') player.dx = player.speed;
            });

            document.addEventListener('keyup', function (e) {
                if (e.key === 'ArrowLeft' || e.key === 'ArrowRight') player.dx = 0;
            });


            update();
        }

        // Key listeners here...

    </script>
</body>

</html>
